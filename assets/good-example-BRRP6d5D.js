import{r as P,j as s}from"./index--ZQpdaMo.js";import{_ as te}from"./extends-CF3RwP-h.js";import{p as A}from"./data-C7H5Vpb9.js";function U(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function F(r,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},F(r,t)}function re(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,F(r,t)}var $=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function ie(r,t){return!!(r===t||$(r)&&$(t))}function ne(r,t){if(r.length!==t.length)return!1;for(var o=0;o<r.length;o++)if(!ie(r[o],t[o]))return!1;return!0}function M(r,t){t===void 0&&(t=ne);var o,l=[],h,b=!1;function z(){for(var g=[],S=0;S<arguments.length;S++)g[S]=arguments[S];return b&&o===this&&t(g,l)||(h=r.apply(this,g),b=!0,o=this,l=g),h}return z}var oe=typeof performance=="object"&&typeof performance.now=="function",q=oe?function(){return performance.now()}:function(){return Date.now()};function H(r){cancelAnimationFrame(r.id)}function se(r,t){var o=q();function l(){q()-o>=t?r.call(null):h.id=requestAnimationFrame(l)}var h={id:requestAnimationFrame(l)};return h}var E=-1;function V(r){if(r===void 0&&(r=!1),E===-1||r){var t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",document.body.appendChild(t),E=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return E}var _=null;function K(r){if(r===void 0&&(r=!1),_===null||r){var t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";var l=document.createElement("div"),h=l.style;return h.width="100px",h.height="100px",t.appendChild(l),document.body.appendChild(t),t.scrollLeft>0?_="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?_="negative":_="positive-ascending"),document.body.removeChild(t),_}return _}var le=150,ae=function(t,o){return t};function ce(r){var t,o=r.getItemOffset,l=r.getEstimatedTotalSize,h=r.getItemSize,b=r.getOffsetForIndexAndAlignment,z=r.getStartIndexForOffset,g=r.getStopIndexForStartIndex,S=r.initInstanceProps,O=r.shouldResetStyleCacheOnItemSizeChange,I=r.validateProps;return t=function(T){re(w,T);function w(p){var e;return e=T.call(this,p)||this,e._instanceProps=S(e.props,U(e)),e._outerRef=void 0,e._resetIsScrollingTimeoutId=null,e.state={instance:U(e),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof e.props.initialScrollOffset=="number"?e.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},e._callOnItemsRendered=void 0,e._callOnItemsRendered=M(function(i,n,a,d){return e.props.onItemsRendered({overscanStartIndex:i,overscanStopIndex:n,visibleStartIndex:a,visibleStopIndex:d})}),e._callOnScroll=void 0,e._callOnScroll=M(function(i,n,a){return e.props.onScroll({scrollDirection:i,scrollOffset:n,scrollUpdateWasRequested:a})}),e._getItemStyle=void 0,e._getItemStyle=function(i){var n=e.props,a=n.direction,d=n.itemSize,m=n.layout,c=e._getItemStyleCache(O&&d,O&&m,O&&a),u;if(c.hasOwnProperty(i))u=c[i];else{var f=o(e.props,i,e._instanceProps),x=h(e.props,i,e._instanceProps),y=a==="horizontal"||m==="horizontal",j=a==="rtl",N=y?f:0;c[i]=u={position:"absolute",left:j?void 0:N,right:j?N:void 0,top:y?0:f,height:y?"100%":x,width:y?x:"100%"}}return u},e._getItemStyleCache=void 0,e._getItemStyleCache=M(function(i,n,a){return{}}),e._onScrollHorizontal=function(i){var n=i.currentTarget,a=n.clientWidth,d=n.scrollLeft,m=n.scrollWidth;e.setState(function(c){if(c.scrollOffset===d)return null;var u=e.props.direction,f=d;if(u==="rtl")switch(K()){case"negative":f=-d;break;case"positive-descending":f=m-a-d;break}return f=Math.max(0,Math.min(f,m-a)),{isScrolling:!0,scrollDirection:c.scrollOffset<f?"forward":"backward",scrollOffset:f,scrollUpdateWasRequested:!1}},e._resetIsScrollingDebounced)},e._onScrollVertical=function(i){var n=i.currentTarget,a=n.clientHeight,d=n.scrollHeight,m=n.scrollTop;e.setState(function(c){if(c.scrollOffset===m)return null;var u=Math.max(0,Math.min(m,d-a));return{isScrolling:!0,scrollDirection:c.scrollOffset<u?"forward":"backward",scrollOffset:u,scrollUpdateWasRequested:!1}},e._resetIsScrollingDebounced)},e._outerRefSetter=function(i){var n=e.props.outerRef;e._outerRef=i,typeof n=="function"?n(i):n!=null&&typeof n=="object"&&n.hasOwnProperty("current")&&(n.current=i)},e._resetIsScrollingDebounced=function(){e._resetIsScrollingTimeoutId!==null&&H(e._resetIsScrollingTimeoutId),e._resetIsScrollingTimeoutId=se(e._resetIsScrolling,le)},e._resetIsScrolling=function(){e._resetIsScrollingTimeoutId=null,e.setState({isScrolling:!1},function(){e._getItemStyleCache(-1,null)})},e}w.getDerivedStateFromProps=function(e,i){return de(e,i),I(e),null};var v=w.prototype;return v.scrollTo=function(e){e=Math.max(0,e),this.setState(function(i){return i.scrollOffset===e?null:{scrollDirection:i.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(e,i){i===void 0&&(i="auto");var n=this.props,a=n.itemCount,d=n.layout,m=this.state.scrollOffset;e=Math.max(0,Math.min(e,a-1));var c=0;if(this._outerRef){var u=this._outerRef;d==="vertical"?c=u.scrollWidth>u.clientWidth?V():0:c=u.scrollHeight>u.clientHeight?V():0}this.scrollTo(b(this.props,e,i,m,this._instanceProps,c))},v.componentDidMount=function(){var e=this.props,i=e.direction,n=e.initialScrollOffset,a=e.layout;if(typeof n=="number"&&this._outerRef!=null){var d=this._outerRef;i==="horizontal"||a==="horizontal"?d.scrollLeft=n:d.scrollTop=n}this._callPropsCallbacks()},v.componentDidUpdate=function(){var e=this.props,i=e.direction,n=e.layout,a=this.state,d=a.scrollOffset,m=a.scrollUpdateWasRequested;if(m&&this._outerRef!=null){var c=this._outerRef;if(i==="horizontal"||n==="horizontal")if(i==="rtl")switch(K()){case"negative":c.scrollLeft=-d;break;case"positive-ascending":c.scrollLeft=d;break;default:var u=c.clientWidth,f=c.scrollWidth;c.scrollLeft=f-u-d;break}else c.scrollLeft=d;else c.scrollTop=d}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&H(this._resetIsScrollingTimeoutId)},v.render=function(){var e=this.props,i=e.children,n=e.className,a=e.direction,d=e.height,m=e.innerRef,c=e.innerElementType,u=e.innerTagName,f=e.itemCount,x=e.itemData,y=e.itemKey,j=y===void 0?ae:y,N=e.layout,G=e.outerElementType,B=e.outerTagName,Y=e.style,J=e.useIsScrolling,Q=e.width,k=this.state.isScrolling,R=a==="horizontal"||N==="horizontal",X=R?this._onScrollHorizontal:this._onScrollVertical,L=this._getRangeToRender(),Z=L[0],ee=L[1],W=[];if(f>0)for(var C=Z;C<=ee;C++)W.push(P.createElement(i,{data:x,key:j(C,x),index:C,isScrolling:J?k:void 0,style:this._getItemStyle(C)}));var D=l(this.props,this._instanceProps);return P.createElement(G||B||"div",{className:n,onScroll:X,ref:this._outerRefSetter,style:te({position:"relative",height:d,width:Q,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:a},Y)},P.createElement(c||u||"div",{children:W,ref:m,style:{height:R?"100%":D,pointerEvents:k?"none":void 0,width:R?D:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var e=this.props.itemCount;if(e>0){var i=this._getRangeToRender(),n=i[0],a=i[1],d=i[2],m=i[3];this._callOnItemsRendered(n,a,d,m)}}if(typeof this.props.onScroll=="function"){var c=this.state,u=c.scrollDirection,f=c.scrollOffset,x=c.scrollUpdateWasRequested;this._callOnScroll(u,f,x)}},v._getRangeToRender=function(){var e=this.props,i=e.itemCount,n=e.overscanCount,a=this.state,d=a.isScrolling,m=a.scrollDirection,c=a.scrollOffset;if(i===0)return[0,0,0,0];var u=z(this.props,c,this._instanceProps),f=g(this.props,u,c,this._instanceProps),x=!d||m==="backward"?Math.max(1,n):1,y=!d||m==="forward"?Math.max(1,n):1;return[Math.max(0,u-x),Math.max(0,Math.min(i-1,f+y)),u,f]},w}(P.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var de=function(t,o){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,o.instance},ue=ce({getItemOffset:function(t,o){var l=t.itemSize;return o*l},getItemSize:function(t,o){var l=t.itemSize;return l},getEstimatedTotalSize:function(t){var o=t.itemCount,l=t.itemSize;return l*o},getOffsetForIndexAndAlignment:function(t,o,l,h,b,z){var g=t.direction,S=t.height,O=t.itemCount,I=t.itemSize,T=t.layout,w=t.width,v=g==="horizontal"||T==="horizontal",p=v?w:S,e=Math.max(0,O*I-p),i=Math.min(e,o*I),n=Math.max(0,o*I-p+I+z);switch(l==="smart"&&(h>=n-p&&h<=i+p?l="auto":l="center"),l){case"start":return i;case"end":return n;case"center":{var a=Math.round(n+(i-n)/2);return a<Math.ceil(p/2)?0:a>e+Math.floor(p/2)?e:a}case"auto":default:return h>=n&&h<=i?h:h<n?n:i}},getStartIndexForOffset:function(t,o){var l=t.itemCount,h=t.itemSize;return Math.max(0,Math.min(l-1,Math.floor(o/h)))},getStopIndexForStartIndex:function(t,o,l){var h=t.direction,b=t.height,z=t.itemCount,g=t.itemSize,S=t.layout,O=t.width,I=h==="horizontal"||S==="horizontal",T=o*g,w=I?O:b,v=Math.ceil((w+l-T)/g);return Math.max(0,Math.min(z-1,o+v-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});const he=()=>{console.log("üìã Virtualized Feed rendered - Only rendering visible posts");const r=({index:t,style:o})=>{const l=A[t];return s.jsx("div",{style:o,children:s.jsx("div",{className:"p-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("img",{src:l.avatar,alt:l.author,className:"w-10 h-10 rounded-full"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:l.author}),s.jsx("div",{className:"text-sm text-gray-500",children:l.timestamp})]})]}),s.jsx("p",{className:"text-gray-800",children:l.content}),s.jsxs("div",{className:"flex space-x-4 text-sm text-gray-500",children:[s.jsxs("span",{children:["‚ù§Ô∏è ",l.likes," likes"]}),s.jsxs("span",{children:["üí¨ ",l.comments," comments"]})]})]})})})};return s.jsx(ue,{height:600,width:"100%",itemCount:A.length,itemSize:180,children:r})},ve=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"prose",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"‚úÖ Good Example: Virtualized List"}),s.jsx("p",{children:"This example uses react-window to virtualize the list of 10,000 items. Notice how:"}),s.jsxs("ul",{className:"list-disc list-inside",children:[s.jsx("li",{children:"Initial page load is instant"}),s.jsx("li",{children:"Scrolling is smooth (60fps)"}),s.jsx("li",{children:"Memory usage stays low"}),s.jsx("li",{children:"Only ~5-10 items are rendered at a time"})]})]}),s.jsx("div",{className:"p-4 bg-green-50 rounded",children:s.jsx("p",{className:"text-sm text-green-700",children:"üëÜ Performance stays snappy because only visible posts are rendered (~5-10 posts instead of all 10,000)"})}),s.jsx("div",{className:"border border-gray-200 rounded",children:s.jsx(he,{})}),s.jsx("div",{className:"bg-yellow-100 p-4 rounded",children:s.jsx("p",{className:"text-sm",children:"üëâ Open Chrome DevTools Performance tab and record while scrolling. You'll notice consistently low CPU usage and smooth 60fps scrolling."})}),s.jsxs("div",{className:"prose",children:[s.jsx("h2",{className:"text-xl font-bold",children:"How it works"}),s.jsx("p",{children:"The virtualization library (react-window) only renders the items that are currently visible in the viewport, plus a small buffer above and below. As you scroll, it:"}),s.jsxs("ol",{className:"list-decimal list-inside",children:[s.jsx("li",{children:"Recycles DOM nodes instead of creating new ones"}),s.jsx("li",{children:"Updates content and position of recycled nodes"}),s.jsx("li",{children:"Maintains scroll position and momentum"}),s.jsx("li",{children:"Handles scroll events efficiently"})]})]})]});export{ve as default};
